tinymce.PluginManager.add("kleargallery", function(e) {

    e.addButton("kleargallery", {
        text : "Gallery",
        icon : !1,
        onclick : function() {

            $.klear.request(
            {
              file: "GalleryList",
              type: 'dialog',
              screen: 'Gallery_dialog',
              post : {}
              },
              function(data) {

                var $dialog = $(e.settings._contentTab).klearModule("showDialog",
                    '<br />',
                    {
                        title: 'Galer√≠a',
                        width: 460,
                        height: 350,
                        template : "<div>Loading...</div>",
                        buttons : [
                            {
                                text: "Cerrar",
                                click: function() {

                                    $(this).moduleDialog("close");
                                }
                            },
                        ]
                    }
                );

                  if(!data.error) {

                      var content = $.tmpl(data.data.templateName, data.data, $.klearmatrix.templatehelper);
                      $dialog.klearModule("getModuleDialog").gallery(data);

                  } else {

                      //self.standardError(data.error);
                  }

              },function(data) {

                    //self.standardError(data.error);
              }
            );
        }
    });

}, ["image"]);